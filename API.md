# ArchDash API

## ğŸ¯ æ¦‚è¿°

ArchDash å…·æœ‰æ‰å¹³åŒ–çš„APIè®¾è®¡ï¼Œå®ç°äº†ç»ˆæç®€åŒ–çš„è®¡ç®—å›¾æ“ä½œã€‚é€šè¿‡å®Œå…¨å»é™¤èŠ‚ç‚¹å±‚çº§ï¼Œç”¨æˆ·å¯ä»¥ç›´æ¥æ“ä½œå‚æ•°ï¼Œäº«å—æè‡´ç®€å•çš„ä½¿ç”¨ä½“éªŒã€‚

## ğŸš€ æ ¸å¿ƒç‰¹æ€§

### 1. ç»ˆæç®€åŒ–çš„è¯­æ³•
```python
from core import Graph

g = Graph("æˆ‘çš„è®¾è®¡")
g["ç”µå‹"] = 1.8        # ç›´æ¥è®¾ç½®å‚æ•°
g["é¢‘ç‡"] = 3.0        # æ— éœ€èŠ‚ç‚¹æ¦‚å¿µ
g["æ ¸å¿ƒæ•°"] = 8

print(g["ç”µå‹"])       # ç›´æ¥è®¿é—®å‚æ•°
```

### 2. è‡ªåŠ¨ä¾èµ–è¿½è¸ª
```python
def power():
    return g["ç”µå‹"] ** 2 * g["æ ¸å¿ƒæ•°"] * 0.5

g.add_computed("åŠŸè€—", power)  # è‡ªåŠ¨æ£€æµ‹ä¾èµ– [ç”µå‹, æ ¸å¿ƒæ•°]
```

### 3. å®æ—¶è®¡ç®—ä¸æ›´æ–°
```python
print(g["åŠŸè€—"])       # 12.96
g["ç”µå‹"] = 1.2        # ä¿®æ”¹å‚æ•°
print(g["åŠŸè€—"])       # 5.76 (è‡ªåŠ¨é‡ç®—)
```

## ğŸ“š å®Œæ•´ä½¿ç”¨æŒ‡å—

### åŸºç¡€æ“ä½œ

#### åˆ›å»ºå›¾å¹¶è®¾ç½®å‚æ•°
```python
from core import Graph

g = Graph("å¤„ç†å™¨è®¾è®¡")

# ç›´æ¥è®¾ç½®å‚æ•°
g["å·¥è‰º_èŠ‚ç‚¹"] = 7      # nm
g["å·¥è‰º_ç”µå‹"] = 1.8    # V  
g["å·¥è‰º_é¢‘ç‡"] = 3.0    # GHz
g["CPU_æ ¸å¿ƒæ•°"] = 8
g["CPU_ç¼“å­˜"] = 32     # MB
```

#### æ‰¹é‡è®¾ç½®å‚æ•°
```python
g.update({
    "åŸºç¡€é¢‘ç‡": 2.5,
    "åŠ é€Ÿé¢‘ç‡": 3.8,
    "ç”µå‹": 1.8,
    "æ ¸å¿ƒæ•°": 8,
    "çº¿ç¨‹æ•°": 16
})
```

### è®¡ç®—å‚æ•°

#### æ·»åŠ è®¡ç®—å‡½æ•°
```python
def cpu_power():
    """CPUåŠŸè€—è®¡ç®—"""
    voltage = g["å·¥è‰º_ç”µå‹"]
    cores = g["CPU_æ ¸å¿ƒæ•°"]
    return voltage ** 2 * cores * 0.5

def cpu_performance():
    """CPUæ€§èƒ½è®¡ç®—"""
    cores = g["CPU_æ ¸å¿ƒæ•°"]
    frequency = g["å·¥è‰º_é¢‘ç‡"]
    return cores * frequency * 8  # GFLOPS

def efficiency():
    """èƒ½æ•ˆæ¯”è®¡ç®—"""
    perf = g["CPU_æ€§èƒ½"]
    power = g["CPU_åŠŸè€—"]
    return perf / power if power > 0 else 0

# æ·»åŠ è®¡ç®—å‚æ•°
g.add_computed("CPU_åŠŸè€—", cpu_power, "CPUåŠŸè€—è®¡ç®—")
g.add_computed("CPU_æ€§èƒ½", cpu_performance, "CPUæ€§èƒ½è®¡ç®—")
g.add_computed("èƒ½æ•ˆæ¯”", efficiency, "èƒ½æ•ˆæ¯”è®¡ç®—")
```

#### è®¿é—®è®¡ç®—ç»“æœ
```python
print(f"CPUåŠŸè€—: {g['CPU_åŠŸè€—']:.2f}W")
print(f"CPUæ€§èƒ½: {g['CPU_æ€§èƒ½']:.0f}GFLOPS")
print(f"èƒ½æ•ˆæ¯”: {g['èƒ½æ•ˆæ¯”']:.2f}GFLOPS/W")
```

### å‚æ•°åˆ†ç»„ï¼ˆå¯é€‰ï¼‰

```python
# è®¾ç½®å‚æ•°åˆ†ç»„
g.set_group("å·¥è‰º_èŠ‚ç‚¹", "å·¥è‰ºå‚æ•°")
g.set_group("å·¥è‰º_ç”µå‹", "å·¥è‰ºå‚æ•°")
g.set_group("å·¥è‰º_é¢‘ç‡", "å·¥è‰ºå‚æ•°")
g.set_group("CPU_æ ¸å¿ƒæ•°", "CPUå‚æ•°")
g.set_group("CPU_ç¼“å­˜", "CPUå‚æ•°")

# æŸ¥çœ‹ç»“æ„
g.print_structure()
```

### ä¾èµ–å…³ç³»æŸ¥çœ‹

```python
# æŸ¥çœ‹è®¡ç®—å‚æ•°çš„ä¾èµ–å…³ç³»
info = g.get_computed_info("CPU_åŠŸè€—")
print(f"ä¾èµ–: {info['dependencies']}")  # ['å·¥è‰º_ç”µå‹', 'CPU_æ ¸å¿ƒæ•°']

# æŸ¥çœ‹æ‰€æœ‰å‚æ•°
print(f"æ‰€æœ‰å‚æ•°: {g.keys()}")
```

### ä¿å­˜å’ŒåŠ è½½

```python
# ä¿å­˜å›¾
g.save("/path/to/design.json")

# åŠ è½½å›¾
g2 = Graph.load("/path/to/design.json")
```

## ğŸ¯ å®é™…ä½¿ç”¨ç¤ºä¾‹

### ç¤ºä¾‹1: ç®€å•çš„å¤„ç†å™¨è®¾è®¡
```python
from core import Graph

g = Graph("ç®€å•å¤„ç†å™¨")

# è®¾ç½®åŸºç¡€å‚æ•°
g["ç”µå‹"] = 1.8
g["é¢‘ç‡"] = 3.0
g["æ ¸å¿ƒæ•°"] = 8

# å®šä¹‰è®¡ç®—
def power():
    return g["ç”µå‹"] ** 2 * g["æ ¸å¿ƒæ•°"] * 0.5

def performance():
    return g["æ ¸å¿ƒæ•°"] * g["é¢‘ç‡"] * 8

def efficiency():
    return g["æ€§èƒ½"] / g["åŠŸè€—"]

# æ·»åŠ è®¡ç®—å‚æ•°
g.add_computed("åŠŸè€—", power)
g.add_computed("æ€§èƒ½", performance)
g.add_computed("æ•ˆç‡", efficiency)

# æŸ¥çœ‹ç»“æœ
print(f"åŠŸè€—: {g['åŠŸè€—']:.2f}W")
print(f"æ€§èƒ½: {g['æ€§èƒ½']:.0f}GFLOPS")
print(f"æ•ˆç‡: {g['æ•ˆç‡']:.2f}GFLOPS/W")

# ä¼˜åŒ–å‚æ•°
g["ç”µå‹"] = 1.2  # é™ä½ç”µå‹
g["é¢‘ç‡"] = 3.5  # æé«˜é¢‘ç‡
print(f"ä¼˜åŒ–åæ•ˆç‡: {g['æ•ˆç‡']:.2f}GFLOPS/W")
```

### ç¤ºä¾‹2: å¤æ‚ç³»ç»Ÿè®¾è®¡
```python
from core import Graph

g = Graph("å¤æ‚ç³»ç»Ÿ")

# æ‰¹é‡è®¾ç½®å‚æ•°
params = {
    "CPU_æ ¸å¿ƒæ•°": 16,
    "CPU_é¢‘ç‡": 3.5,
    "CPU_ç”µå‹": 1.2,
    "GPU_æ ¸å¿ƒæ•°": 2048,
    "GPU_é¢‘ç‡": 2.5,
    "å†…å­˜_å®¹é‡": 64,
    "å†…å­˜_é¢‘ç‡": 3200,
    "ç¯å¢ƒæ¸©åº¦": 25
}
g.update(params)

# å®šä¹‰å¤æ‚è®¡ç®—
def cpu_power():
    return g["CPU_ç”µå‹"] ** 2 * g["CPU_æ ¸å¿ƒæ•°"] * g["CPU_é¢‘ç‡"] * 0.3

def gpu_power():
    return g["GPU_æ ¸å¿ƒæ•°"] * g["GPU_é¢‘ç‡"] * 0.0005

def memory_power():
    return g["å†…å­˜_å®¹é‡"] * g["å†…å­˜_é¢‘ç‡"] * 0.001

def total_power():
    return g["CPU_åŠŸè€—"] + g["GPU_åŠŸè€—"] + g["å†…å­˜_åŠŸè€—"] + 20  # 20WåŸºç¡€åŠŸè€—

def temperature():
    return g["ç¯å¢ƒæ¸©åº¦"] + g["æ€»åŠŸè€—"] * 0.8  # çƒ­é˜»è®¡ç®—

def cpu_score():
    return g["CPU_æ ¸å¿ƒæ•°"] * g["CPU_é¢‘ç‡"] * 10

def gpu_score():
    return g["GPU_æ ¸å¿ƒæ•°"] * g["GPU_é¢‘ç‡"] * 0.1

def total_score():
    return g["CPU_è¯„åˆ†"] + g["GPU_è¯„åˆ†"]

def efficiency():
    return g["æ€»è¯„åˆ†"] / g["æ€»åŠŸè€—"]

# æ‰¹é‡æ·»åŠ è®¡ç®—å‚æ•°
computations = [
    ("CPU_åŠŸè€—", cpu_power, "CPUåŠŸè€—"),
    ("GPU_åŠŸè€—", gpu_power, "GPUåŠŸè€—"),
    ("å†…å­˜_åŠŸè€—", memory_power, "å†…å­˜åŠŸè€—"),
    ("æ€»åŠŸè€—", total_power, "æ€»åŠŸè€—"),
    ("èŠ¯ç‰‡æ¸©åº¦", temperature, "èŠ¯ç‰‡æ¸©åº¦"),
    ("CPU_è¯„åˆ†", cpu_score, "CPUè¯„åˆ†"),
    ("GPU_è¯„åˆ†", gpu_score, "GPUè¯„åˆ†"),
    ("æ€»è¯„åˆ†", total_score, "æ€»è¯„åˆ†"),
    ("èƒ½æ•ˆæ¯”", efficiency, "èƒ½æ•ˆæ¯”")
]

for name, func, desc in computations:
    g.add_computed(name, func, desc)

# æŸ¥çœ‹ç»“æœ
print(f"æ€»åŠŸè€—: {g['æ€»åŠŸè€—']:.2f}W")
print(f"èŠ¯ç‰‡æ¸©åº¦: {g['èŠ¯ç‰‡æ¸©åº¦']:.1f}Â°C")
print(f"æ€»è¯„åˆ†: {g['æ€»è¯„åˆ†']:.0f}")
print(f"èƒ½æ•ˆæ¯”: {g['èƒ½æ•ˆæ¯”']:.2f}")
```

## ğŸ”„ ä¸æ—§APIçš„å¯¹æ¯”

| åŠŸèƒ½ | æ—§API (èŠ‚ç‚¹-å±æ€§) | æ–°API (å®Œå…¨æ‰å¹³) |
|------|------------------|-----------------|
| è®¾ç½®å‚æ•° | `g["CPU"]["é¢‘ç‡"] = 3.0` | `g["CPU_é¢‘ç‡"] = 3.0` |
| è®¿é—®å‚æ•° | `g["CPU"]["é¢‘ç‡"]` | `g["CPU_é¢‘ç‡"]` |
| è®¡ç®—å‡½æ•° | `g["CPU"]["é¢‘ç‡"] * g["CPU"]["ç”µå‹"]` | `g["CPU_é¢‘ç‡"] * g["CPU_ç”µå‹"]` |
| æ·»åŠ è®¡ç®— | `g.add_computed("åŠŸè€—", "CPU", func)` | `g.add_computed("CPU_åŠŸè€—", func)` |
| å¤æ‚åº¦ | ä¸­ç­‰ | æç®€ |
| å­¦ä¹ æˆæœ¬ | éœ€è¦ç†è§£èŠ‚ç‚¹æ¦‚å¿µ | å‡ ä¹æ— å­¦ä¹ æˆæœ¬ |
| ä»£ç å¯è¯»æ€§ | è‰¯å¥½ | ä¼˜ç§€ |

## ğŸ’¡ æœ€ä½³å®è·µ

### 1. å‚æ•°å‘½åçº¦å®š
- ä½¿ç”¨ä¸‹åˆ’çº¿åˆ†éš”é€»è¾‘ç»„ä»¶ï¼š`CPU_é¢‘ç‡`ã€`GPU_æ˜¾å­˜`
- ä¿æŒå‘½åç®€æ´ä½†å…·æè¿°æ€§
- ä½¿ç”¨ä¸€è‡´çš„å‘½åæ¨¡å¼

### 2. åˆ†ç»„ç­–ç•¥
```python
# æŒ‰åŠŸèƒ½åˆ†ç»„
g.set_group("CPU_é¢‘ç‡", "å¤„ç†å™¨")
g.set_group("CPU_æ ¸å¿ƒæ•°", "å¤„ç†å™¨")
g.set_group("GPU_é¢‘ç‡", "æ˜¾å¡")
g.set_group("GPU_æ˜¾å­˜", "æ˜¾å¡")

# æŒ‰è®¡ç®—ç±»å‹åˆ†ç»„
g.add_computed("CPU_åŠŸè€—", func, "åŠŸè€—è®¡ç®—", "åŠŸè€—åˆ†æ")
g.add_computed("GPU_åŠŸè€—", func, "åŠŸè€—è®¡ç®—", "åŠŸè€—åˆ†æ")
```

### 3. è®¡ç®—å‡½æ•°è®¾è®¡
```python
def good_function():
    """æ¸…æ™°çš„å‡½æ•°ï¼šå•ä¸€èŒè´£ï¼Œæ¸…æ™°çš„ä¾èµ–"""
    voltage = g["ç”µå‹"]
    cores = g["æ ¸å¿ƒæ•°"]
    return voltage ** 2 * cores * 0.5

# é¿å…è¿‡äºå¤æ‚çš„è®¡ç®—å‡½æ•°
def avoid_complex_function():
    """é¿å…ï¼šè¿‡äºå¤æ‚ï¼Œéš¾ä»¥ç†è§£ä¾èµ–å…³ç³»"""
    return (g["A"] + g["B"]) * (g["C"] - g["D"]) / (g["E"] ** g["F"])
```

### 4. æ‰¹é‡æ“ä½œ
```python
# åˆ©ç”¨æ‰¹é‡æ›´æ–°æé«˜æ•ˆç‡
updates = {
    "param1": value1,
    "param2": value2,
    "param3": value3
}
g.update(updates)

# æ‰¹é‡æ·»åŠ è®¡ç®—å‚æ•°
for name, func, desc in computations:
    g.add_computed(name, func, desc)
```

## ğŸ‰ æ€»ç»“

ArchDash çš„æ‰å¹³åŒ–APIå®ç°äº†ï¼š

- **ğŸ¯ ç»ˆæç®€åŒ–**: `g["å‚æ•°"] = å€¼` çš„æç®€è¯­æ³•
- **ğŸ”„ é›¶é…ç½®ä¾èµ–**: å®Œå…¨è‡ªåŠ¨çš„ä¾èµ–æ£€æµ‹å’Œç®¡ç†
- **ğŸ“¦ æ‰å¹³ç»“æ„**: å»é™¤æ‰€æœ‰ä¸å¿…è¦çš„åµŒå¥—ç»“æ„
- **ğŸ·ï¸ çµæ´»ç»„ç»‡**: å¯é€‰çš„å‚æ•°åˆ†ç»„åŠŸèƒ½
- **âš¡ é«˜æ•ˆæ“ä½œ**: æ”¯æŒæ‰¹é‡è®¾ç½®å’Œæ›´æ–°
- **ğŸš€ æè‡´æ€§èƒ½**: æœ€ç›´æ¥çš„å‚æ•°è®¿é—®æ–¹å¼
- **ğŸ’¡ é›¶å­¦ä¹ æˆæœ¬**: æ¥è¿‘åŸç”ŸPythonå­—å…¸çš„ä½¿ç”¨ä½“éªŒ

è¿™ç§è®¾è®¡è®© ArchDash æˆä¸ºäº†å¸‚é¢ä¸Šæœ€ç®€å•æ˜“ç”¨çš„è®¡ç®—å›¾åº“ï¼ŒåŒæ—¶ä¿æŒäº†å¼ºå¤§çš„åŠŸèƒ½å’Œä¼˜ç§€çš„æ€§èƒ½ã€‚