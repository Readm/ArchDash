# 🔗 增强的依赖关系和计算过程展示功能

## 📋 功能概述

这个增强功能将原来简单的依赖关系展示升级为一个功能丰富的多标签页界面，不仅展示参数间的依赖关系，还提供详细的计算过程分析和实时敏感性分析。

## 🎯 主要改进

### 1. 📊 增强的统计信息
- **计算图健康度**：显示整体系统的健康状况
- **计算复杂度分布**：按简单、中等、复杂分类显示参数
- **依赖关系统计**：总参数数、有依赖关系的参数数、计算参数数等

### 2. 🔗 详细的依赖关系展示
- **依赖强度分析**：根据参数更新频率分析依赖强度（高频更新、正常、静态值）
- **置信度显示**：每个参数的置信度用颜色编码显示
- **最后更新时间**：显示依赖参数的最后更新时间

### 3. ⚙️ 计算流程可视化
- **输入参数展示**：显示所有输入参数及其当前值
- **计算过程展示**：展示计算函数代码和复杂度
- **输出结果展示**：显示计算结果和置信度
- **影响范围展示**：显示此参数会影响哪些其他计算

### 4. 📈 实时分析功能
- **参数敏感性分析**：评估参数修改的影响范围
- **计算链条分析**：显示完整的计算执行步骤
- **影响分析**：列出修改此参数会影响的所有计算
- **敏感性评估**：根据影响范围给出敏感性等级

## 🎨 界面布局

### 标签页结构
```
📊 依赖关系面板
├── 🔗 依赖关系    (原有功能的增强版)
├── ⚙️ 计算流程    (新增：可视化计算过程)
└── 📈 实时分析    (新增：参数敏感性分析)
```

### 功能按钮
- **🔄 刷新**: 手动刷新所有显示面板
- **🔽 展开/折叠**: 控制面板的显示状态

## 🚀 使用方法

### 1. 查看依赖关系
1. 点击依赖关系面板的展开按钮
2. 切换到 "🔗 依赖关系" 标签页
3. 查看详细的参数依赖网络，包括：
   - 参数基本信息（名称、值、单位、描述）
   - 置信度（颜色编码：绿色≥80%，黄色≥50%，红色<50%）
   - 计算状态（简单计算、中等复杂度、复杂计算）
   - 输入依赖和输出影响

### 2. 分析计算流程
1. 切换到 "⚙️ 计算流程" 标签页
2. 查看每个计算参数的完整流程：
   - 📥 输入参数：显示所有依赖的参数及其值
   - ⚙️ 计算过程：显示计算函数代码和复杂度
   - 📤 输出结果：显示计算结果和置信度
   - 🎯 影响范围：显示此参数影响的其他计算

### 3. 进行实时分析
1. 切换到 "📈 实时分析" 标签页
2. 从下拉菜单中选择要分析的参数
3. 点击 "开始分析" 按钮
4. 查看详细的分析结果：
   - 🎯 分析目标：参数基本信息
   - 🔄 计算链条分析：详细的计算执行步骤
   - 📊 影响分析：修改此参数会影响的计算
   - 🎯 敏感性评估：敏感性等级和评分

## 🔧 技术特性

### 增强的数据结构
```python
param_info = {
    'node_id': '节点ID',
    'node_name': '节点名称',
    'param_name': '参数名称',
    'param_value': '参数值',
    'param_unit': '参数单位',
    'param_confidence': '置信度',
    'calculation_status': '计算状态',
    'dependencies': [
        {
            'node_name': '依赖节点名',
            'param_name': '依赖参数名',
            'dependency_strength': '依赖强度',
            'last_updated': '最后更新时间'
        }
    ],
    'calculation_chain': ['计算执行步骤'],
    
    'calculation_error': '错误信息'
}
```

### 新增函数
- `get_all_parameter_dependencies()`: 获取增强的依赖关系信息
- `format_dependencies_display()`: 格式化依赖关系显示
- `create_calculation_flow_visualization()`: 创建计算流程可视化
- `simulate_parameter_change_and_show_process()`: 模拟参数变化过程

## 📊 示例场景

### 结构工程计算示例
```
输入参数节点
├── 长度 (10.0 m, 置信度: 95%)
├── 宽度 (5.0 m, 置信度: 90%)
└── 高度 (3.0 m, 置信度: 85%)

几何计算节点
├── 面积 (依赖: 长度×宽度, 复杂度: 简单)
└── 体积 (依赖: 面积×高度, 复杂度: 简单)

结构分析节点
├── 重量 (依赖: 体积×密度, 复杂度: 简单)
└── 刚度 (依赖: 弹性模量×面积/长度, 复杂度: 中等)

性能评估节点
└── 效率指标 (依赖: 刚度/重量, 复杂度: 中等)
```

## 🎯 敏感性分析示例

当分析 "长度" 参数时，系统会显示：
- **影响范围**: 面积 → 体积 → 重量, 面积 → 刚度 → 效率指标
- **敏感性等级**: 高 (影响5个参数的计算)
- **计算链条**: 显示完整的计算传播过程

## 🔄 实时更新

所有显示面板都会在以下情况自动更新：
- 添加/删除节点
- 修改参数值
- 更改计算函数
- 调整依赖关系

## 🎨 视觉设计

### 颜色编码
- **置信度**: 绿色(≥80%) | 黄色(≥50%) | 红色(<50%)
- **依赖强度**: 橙色(高频) | 蓝色(正常) | 灰色(静态)
- **敏感性**: 红色(高) | 黄色(中) | 绿色(低)

### 图标系统
- 📊 统计信息
- 🔗 依赖关系
- ⚙️ 计算过程
- 📈 实时分析
- 🎯 分析目标
- 🔄 计算链条

## 🧪 测试和验证

运行以下命令来测试功能：

```bash
# 基础功能测试
python test_enhanced_dependencies.py

# 完整演示
python demo_enhanced_dependencies.py
```

## 🚀 未来扩展

计划中的功能增强：
- 📊 计算性能监控
- 🔍 参数变化历史追踪
- 📈 敏感性热力图
- 🎯 自动优化建议
- 💾 计算结果缓存

## 📝 总结

这个增强功能将简单的依赖关系列表转变为一个功能丰富的分析工具，帮助用户：
1. **理解系统结构**：通过可视化的依赖网络
2. **分析计算过程**：通过详细的流程展示
3. **评估参数影响**：通过实时敏感性分析
4. **监控系统健康**：通过统计信息和健康度指标

这使得 ArchDash 不仅仅是一个参数管理工具，更是一个强大的系统分析平台。 